#region Header
//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                                                                                                                                  //
//  ____ ___   ______   .______       _______      ___      .__   __.    .___________.____    ____ .______    _______ .______                                       //
//  |  |/  /  /  __  \  |   _  \     |   ____|    /   \     |  \ |  |    |           |\   \  /   / |   _  \  |   ____||   _  \                                      //
//  |  '  /  |  |  |  | |  |_)  |    |  |__      /  ^  \    |   \|  |    `---|  |----` \   \/   /  |  |_)  | |  |__   |  |_)  |                                     //
//  |    <   |  |  |  | |      /     |   __|    /  /_\  \   |  . `  |        |  |       \_    _/   |   ___/  |   __|  |      /                                      //
//  |  .  \  |  `--'  | |  |\  \----.|  |____  /  _____  \  |  |\   |        |  |         |  |     |  |      |  |____ |  |\  \----.                                 //
//  |__|\__\  \______/  | _| `._____||_______|/__/     \__\ |__| \__|        |__|         |__|     | _|      |_______|| _| `._____|                                 //
//                                                                                                                                                                  //
//  í•œêµ­ì–´ íƒ€ìê¸° ì…ë ¥                                                                                                                                              //
//  2022.09.06 KimYC1223                                                                                                                                            //
//  https://KimYC1223.github.io/                                                                                                                                    //
//                                                                                                                                                                  //
//  ìì„¸í•œ ì‚¬ìš©ë²•ì€ https://github.com/KimYC1223/KoreanTyperë¥¼ ì°¸ê³ í•˜ì„¸ìš” !                                                                                         //
//                                                                                                                                                                  //
//  -------------------------------------------------------------------------------------------------------------------------------------------------------------   //
//  The MIT License (MIT)                                                                                                                                           //
//                                                                                                                                                                  //
//  Copyright(c) 2022 KimYC1223                                                                                                                                     //
//                                                                                                                                                                  //
//  Permission is hereby granted, free of charge, to any person obtaining a copy of this software and associated documentation files (the "Software"), to deal      //
//  in the Software without restriction, including without limitation the rights to use, copy, modify, merge, publish, distribute, sublicense, and/or sell copies   //
//  of the Software, and to permit persons to whom the Software is furnished to do so, subject to the following conditions:                                         //
//  The above copyright notice and this permission notice shall be included in all copies or substantial portions of the Software.                                  //
//                                                                                                                                                                  //
//  THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,             //
//  FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY,   //
//  WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.      //
//                                                                                                                                                                  //
//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
#endregion

//====================================================================================================================================================================
//    KoreanTyper ë„¤ì„ ìŠ¤í˜ì´ìŠ¤ ì‚¬ìš©
//====================================================================================================================================================================
namespace KoreanTyper {

    //================================================================================================================================================================
    //    string ìë£Œí˜•ì˜ Extention class
    //================================================================================================================================================================
    public static class stringExtensions  {

        #region MemberVariables
        //============================================================================================================================================================
        //    í•œê¸€ì˜ ì´ˆì„±, ì¤‘ì„±, ì¢…ì„± ëª¨ìŒ
        //============================================================================================================================================================
        private static char[] consonants = { 'ã„±','ã„²','ã„´','ã„·','ã„¸',
                                                    'ã„¹','ã…','ã…‚','ã…ƒ','ã……',
                                                    'ã…†','ã…‡','ã…ˆ','ã…‰','ã…Š',
                                                    'ã…‹','ã…Œ','ã…','ã…' };

        private static char[] vowels = { 'ã…','ã…','ã…‘','ã…’','ã…“',
                                                    'ã…”','ã…•','ã…–','ã…—','ã…˜',
                                                    'ã…™','ã…š','ã…›','ã…œ','ã…',
                                                    'ã…','ã…Ÿ','ã… ','ã…¡','ã…¢',
                                                    'ã…£' };
        private static char[] jongseong = { ' ','ã„±','ã„²','ã„³','ã„´',
                                                    'ã„µ','ã„¶','ã„·','ã„¹','ã„º',
                                                    'ã„»','ã„¼','ã„½','ã„¾','ã„¿',
                                                    'ã…€','ã…','ã…‚','ã…„','ã……',
                                                    'ã…†','ã…‡','ã…ˆ','ã…Š','ã…‹',
                                                    'ã…Œ','ã…','ã…' };
        #endregion


        #region is_abnormalFunction
        //==========================================================================================================================================================
        // is_abnormal : ì´ˆì„±ì´ ì—†ëŠ” íŠ¹ìˆ˜ í•œê¸€ ì¤‘, ë‘ê°€ì§€ ëª¨ìŒì´ í•©ì³ì§„ ê²½ìš°ë¥¼ ì°¾ëŠ” í•¨ìˆ˜
        //==========================================================================================================================================================
        /// <summary>
        /// ì´ˆì„±ì´ ì—†ëŠ” íŠ¹ìˆ˜ í•œê¸€ ì¤‘, ë‘ê°€ì§€ ëª¨ìŒì´ í•©ì³ì§„ ê²½ìš°ë¥¼ ì°¾ëŠ” í•¨ìˆ˜
        /// </summary>
        /// <param name="word">ë¶„ì„í•˜ê³ ì í•˜ëŠ” í•œ ê¸€ì ë‹¨ì–´</param>
        /// <returns></returns>
        private static bool is_abnormal(char word) {
            bool isSpecial = false;
            switch(word) {
                case 'ã…˜': case 'ã…™': case 'ã…š': case 'ã…': case 'ã…': case 'ã…Ÿ': 
                case 'ã…¢': case 'ã„³': case 'ã„µ': case 'ã„¶': case 'ã„º': case 'ã„»':
                case 'ã„¼': case 'ã„½': case 'ã„¾': case 'ã„¿': case 'ã…€': case 'ã…„': 
                    isSpecial = true;
                    break;
                default: isSpecial = false; break;
            }
            return isSpecial;
        }
        //==========================================================================================================================================================
        #endregion


        #region get_typed_lengthFunction
        //==========================================================================================================================================================
        // get_typed_length : í•´ë‹¹ stringì´ ëª‡ ë²ˆì˜ íƒ€ì´í•‘ íšŸìˆ˜ë¥¼ ê±°ì³ ì…ë ¥ë˜ëŠ”ì§€ ì•Œì•„ë³´ëŠ” í•¨ìˆ˜.
        //==========================================================================================================================================================
        /// <summary>
        /// í•´ë‹¹ stringì´ ëª‡ ë²ˆì˜ íƒ€ì´í•‘ íšŸìˆ˜ë¥¼ ê±°ì³ ì…ë ¥ë˜ëŠ”ì§€ ì•Œì•„ë³´ëŠ” í•¨ìˆ˜.
        /// </summary>
        /// <returns></returns>
        public static int get_typed_length (this string str) {

            int result = 0;  // ê²°ê³¼ê°’ ì €ì¥

            // stringì˜ ê¸¸ì´ë§Œí¼ ë°˜ë³µ
            for (int index = 0; index < str.Length; index++) {
                //==================================================================================================================================================
                //  í•œê¸€ì´ ì•„ë‹ˆê±°ë‚˜ ë¶ˆì™„ì „í•œ í•œê¸€ì´ ì•„ë‹ ê²½ìš° ( Ex. 'A', '1', 'â˜…', 'ã…˜' ë“±ë“± ... ) 
                //==================================================================================================================================================
                //  ë¶ˆì™„ì „í•œ í•œê¸€ì€ ë§ëŠ”ë°, 'ã…˜' 'ã…' 'ã„¶' 'ã„³'ì™€ ê°™ì´ 2ë²ˆì— ê±¸ì³ ì…ë ¥í•´ì•¼ í•˜ëŠ”ê²½ìš°
                if (is_abnormal(str[index])) {
                    result += 2; continue; 

                //  ì•ŒíŒŒë²³('A', 'b', ... )ì´ë‚˜ ìˆ«ì('1','2', ... ) ë˜ëŠ” íŠ¹ìˆ˜ë¬¸ì('â—†','ğŸ˜Š', ... )ê±°ë‚˜, ë¶ˆì™„ì „í•œ í•œê¸€('ã„±','ã…', ... )ì¸ ê²½ìš° 
                } else if ((int)str[index] < (int)'ê°€' || (int)str[index] > (int)'í£') {
                    result += 1; continue;
                }


                //==================================================================================================================================================
                //  ì •ìƒì ì¸ í•œê¸€ì¼ ê²½ìš°, í•œê¸€ì„ ì´ˆì„± ì¤‘ì„± ì¢…ì„±ìœ¼ë¡œ ë¶„í•´í•˜ì—¬ ì§„í–‰
                //==================================================================================================================================================
                int wordIntValue = (int)str[index] - (int)'ê°€';
                int korean2ndWord = ( ( wordIntValue ) % ( jongseong.Length * vowels.Length ) ) / jongseong.Length;
                int korean3rdWord = ( wordIntValue ) % jongseong.Length;


                //==================================================================================================================================================
                //  í•´ë‹¹ ê¸€ìì˜ ì´ˆì„±ì„ íƒ€ì´í•‘ í•˜ëŠ”ë° ë“¤ì–´ê°€ëŠ” íšŸìˆ˜ êµ¬í•˜ê¸°
                //==================================================================================================================================================
                //  ì´ˆì„±ì€ ë¬´ì¡°ê±´ í•œ ë²ˆì— ì…ë ¥ ê°€ëŠ¥ 
                result++;


                //==================================================================================================================================================
                //  í•´ë‹¹ ê¸€ìì˜ ì¤‘ì„±ì„ íƒ€ì´í•‘ í•˜ëŠ”ë° ë“¤ì–´ê°€ëŠ” íšŸìˆ˜ êµ¬í•˜ê¸°
                //==================================================================================================================================================
                switch (korean2ndWord) {
                    // ì¤‘ì„±ì˜ ê²½ìš°, 'ã…˜', 'ã…™', 'ã…š', 'ã…', 'ã…', 'ã…Ÿ', 'ã…¢'ëŠ” 2ë²ˆì— ê±¸ì³ ì…ë ¥í•˜ê³ ,
                    case 9: case 10: case 11: case 14: case 15: case 16: case 19:
                        result += 2; break;
                    // ë‚˜ë¨¸ì§€ ê²½ìš°ëŠ” í•œ ë²ˆì— ì…ë ¥ ê°€ëŠ¥
                    default:
                        result += 1; break;
                }


                //==================================================================================================================================================
                //  í•´ë‹¹ ê¸€ìì˜ ì¢…ì„±ì„ íƒ€ì´í•‘ í•˜ëŠ”ë° ë“¤ì–´ê°€ëŠ” íšŸìˆ˜ êµ¬í•˜ê¸°
                //==================================================================================================================================================
                switch (korean3rdWord) {
                    // ì¢…ì„±ì˜ ê²½ìš°, 'ã„³', 'ã„µ', 'ã„¶', 'ã„º', 'ã„»', 'ã„¼', 'ã„½', 'ã„¾', 'ã„¿', 'ã…€', 'ã…„' ëŠ” 2ë²ˆì— ê±¸ì³ ì…ë ¥í•˜ê³ ,
                    case 3: case 5: case 6: case 9: case 10: case 11:
                    case 12: case 13: case 14: case 15: case 18:
                        result += 2; break;
                    // ì¢…ì„±ì´ ì—†ëŠ” ê²½ìš°(ex. 'ê°€', 'ê°¸', ...)ëŠ” ë‹¹ì—°íˆ ì¢…ì„±ì„ 0ë²ˆì— ê±¸ì³ ì…ë ¥í•˜ê³ 
                    case 0: break;
                    // ë‚˜ë¨¸ì§€ ê²½ìš°ì—ëŠ” í•œë²ˆì— ì…ë ¥í•œë‹¤.
                    default: result += 1; break;
                }
            }
            return result;
        }
        //==========================================================================================================================================================
        #endregion


        #region TypingFloatFunction
        //==========================================================================================================================================================
        // Typing : í‚¤ë³´ë“œ íƒ€ì´í•‘ íš¨ê³¼ ì ìš©í•˜ëŠ” í•¨ìˆ˜
        //==========================================================================================================================================================
        /// <summary>
        /// í‚¤ë³´ë“œ íƒ€ì´í•‘ íš¨ê³¼ë¥¼ ì ìš©í•˜ëŠ” í•¨ìˆ˜
        /// </summary>
        /// <param name="percent">(float) í‚¤ë³´ë“œ íš¨ê³¼ ì§„í–‰ë¥  (0 <= percent <= 1)</param>
        /// <returns></returns>
        public static string Typing(this string str, float percent) {

            if (percent >= 1f) return str;                                  // 1 ì´ìƒì´ë©´, 100% ì´ë¯€ë¡œ, ë¬¸ì¥ ì „ì²´ ì¶œë ¥
            if (percent <= 0f) return "";                                   // 0 ì´í•˜ë©´ 0% ì´ë¯€ë¡œ, ì•„ë¬´ê²ƒë„ ì¶œë ¥í•˜ì§€ ì•ŠìŒ
            int maxLength = str.get_typed_length();                          // ì „ì²´ íƒ€ì´í•‘ ì¹´ìš´íŠ¸ ê³„ì‚°

            return str.Typing((int)(maxLength * percent ));                 // int íƒ€ì´í•‘ í•¨ìˆ˜ í˜¸ì¶œ
        }
        //==========================================================================================================================================================
        #endregion


        #region TypingIntFunction
        //==========================================================================================================================================================
        // Typing : í‚¤ë³´ë“œ íƒ€ì´í•‘ íš¨ê³¼ ì ìš©í•˜ëŠ” í•¨ìˆ˜
        //==========================================================================================================================================================
        /// <summary>
        /// í‚¤ë³´ë“œ íƒ€ì´í•‘ íš¨ê³¼ë¥¼ ì ìš©í•˜ëŠ” í•¨ìˆ˜
        /// </summary>
        /// <param name="count">(int) í‚¤ë³´ë“œ íš¨ê³¼ ì§„í–‰ë¥  (0 <= count <= string.get_typed_length())</param>
        /// <returns></returns>
        public static string Typing(this string str, int count) {

            if (count <= 0) return "";                                                  // íƒ€ì´í•‘ ì¹´ìš´íŠ¸ê°€ 0ì´ë¼ë©´, ê³µë°± ì¶œë ¥
            int maxLength = str.get_typed_length();                                      // ë¬¸ì¥ì˜ ìµœëŒ€ íƒ€ì´í•‘ ì¹´ìš´íŠ¸ ê³„ì‚°
            if (count >= maxLength) return str;                                         // íƒ€ì´í•‘ ì¹´ìš´íŠ¸ê°€ ìµœëŒ€ë¥¼ ë„˜ìœ¼ë©´, ë¬¸ì¥ ì „ì²´ ì¶œë ¥

            string result_string = "";                                                  // ìµœì¢…ì ìœ¼ë¡œ ì¶œë ¥í•  ë¬¸ì¥

            //======================================================================================================================================================
            //  ë§¤ ë¬¸ì¥ë§ˆë‹¤ í•œ ê¸€ìì”© í™•ì¸í•˜ê³  (index < str.Length), ì‚¬ìš©ìê°€ ì›í•˜ëŠ” ì¹´ìš´íŠ¸ ë§Œí¼ í™•ì¸ (count > 0)
            //======================================================================================================================================================
            for (int index = 0; index < str.Length && count > 0; index++) {

                bool isSpecial = is_abnormal(str[index]);                                                                   // íŠ¹ìˆ˜í•œ í•œê¸€ì¸ì§€ íŒë‹¨
                int wordIntValue = (int)str[index] - (int)'ê°€';                                                                 // ê¸€ìì˜ intê°’ ì¶”ì 
                int korean2ndWord = (( wordIntValue ) % (jongseong.Length*vowels.Length)) 
                                                                                                / jongseong.Length;     // ì¤‘ì„± êµ¬í•˜ê¸°
                int korean3rdWord = ( wordIntValue ) % jongseong.Length;                                                // ì¢…ì„± êµ¬í•˜ê¸°
                int wordDrawcount = 1;                                                                                          // í•´ë‹¹ ê¸€ìì˜ íƒ€ì´í•‘ ì¹´ìš´íŠ¸


                //##################################################################################################################################################
                //
                //  STEP 1.
                //  í•œê¸€ìì”© í™•ì¸í•˜ë©°, í•´ë‹¹ ê¸€ìì— í•„ìš”í•œ íƒ€ì´í•‘ ì¹´ìš´íŠ¸ë§Œí¼ count ë³€ìˆ˜ë¥¼ ê°ì‚°
                //
                //##################################################################################################################################################
                //  ë¶ˆì™„ì „í•œ í•œê¸€ì€ ë§ëŠ”ë°, 'ã…˜' 'ã…' 'ã„¶' 'ã„³'ì™€ ê°™ì´ 2ë²ˆì— ê±¸ì³ ì…ë ¥í•´ì•¼ í•˜ëŠ”ê²½ìš°
                if (isSpecial)
                    count -= 2;                                     // 2ë²ˆì— ê±¸ì³ ì…ë ¥ ê°€ëŠ¥. count ë³€ìˆ˜ì—ì„œ 2 ê°ì‚°


                //  ì•ŒíŒŒë²³('A', 'b', ... )ì´ë‚˜ ìˆ«ì('1','2', ... ) ë˜ëŠ” íŠ¹ìˆ˜ë¬¸ì('â—†','ğŸ˜Š', ... )ê±°ë‚˜, ë¶ˆì™„ì „í•œ í•œê¸€('ã„±','ã…', ... )ì¸ ê²½ìš° 
                else if ((int)str[index] < (int)'ê°€' || (int)str[index] > (int)'í£') {
                    count -= 1;                                     // í•œë²ˆì— ì…ë ¥ ê°€ëŠ¥.  count ë³€ìˆ˜ì—ì„œ 1 ê°ì‚°
                    result_string += str[index];                    // ê¸€ìë¥¼ ê²°ê³¼ì— ì¶”ê°€
                    continue;                                       // ë‹¤ìŒ ê¸€ìë¡œ


                // ì™„ì „í•œ í•œê¸€('ê°€', 'í„', 'í–', ...)ì¼ ê²½ìš°
                } else {
                    // ì´ˆì„±ì€ ë¬´ì¡°ê±´ 1 ë²ˆì— ì…ë ¥ ê°€ëŠ¥í•˜ë¯€ë¡œ íŒ¨ìŠ¤,

                    // ì¤‘ì„±ì„ ë¶„ì„í•¨
                    switch( korean2ndWord ) {
                        // ì¤‘ì„±ì˜ ê²½ìš°, 'ã…˜', 'ã…™', 'ã…š', 'ã…', 'ã…', 'ã…Ÿ', 'ã…¢'ëŠ” 2ë²ˆì— ê±¸ì³ ì…ë ¥í•˜ê³ ,
                        case 9: case 10: case 11: case 14: case 15: case 16: case 19:
                            wordDrawcount += 2; break;
                        // ë‚˜ë¨¸ì§€ëŠ” í•œë²ˆì— ì…ë ¥ ê°€ëŠ¥
                        default:
                            wordDrawcount += 1; break;
                    }

                    // ì¢…ì„±ì„ ë¶„ì„í•¨
                    switch( korean3rdWord ) {
                        // ì¢…ì„±ì˜ ê²½ìš°, 'ã„³', 'ã„µ', 'ã„¶', 'ã„º', 'ã„»', 'ã„¼', 'ã„½', 'ã„¾', 'ã„¿', 'ã…€', 'ã…„' ëŠ” 2ë²ˆì— ê±¸ì³ ì…ë ¥í•˜ê³ ,
                        case 3: case 5: case 6: case 9: case 10: case 11:
                        case 12:case 13:case 14:case 15:case 18:
                            wordDrawcount += 2; break;
                        // ì¢…ì„±ì´ ì—†ëŠ” ê²½ìš°(ex. 'ê°€', 'ê°¸', ... )ëŠ” ë‹¹ì—°íˆ ì¢…ì„±ì„ 0ë²ˆì— ê±¸ì³ ì…ë ¥í•˜ê³ 
                        case 0: break;
                        // ë‚˜ë¨¸ì§€ ê²½ìš°ì—ëŠ” í•œë²ˆì— ì…ë ¥í•œë‹¤.
                        default: wordDrawcount += 1; break;
                    }

                    // ê³„ì‚°í•œ íƒ€ì´í•‘ ì¹´ìš´íŠ¸ ê²°ê³¼ ë§Œí¼, count ë³€ìˆ˜ì—ì„œ ê°ì‚°
                    count -= wordDrawcount;
                }


                //##################################################################################################################################################
                //
                //  STEP 2.
                //  count ê°’ì„ í†µí•´ ì¶œë ¥í•  stringì„ ê²°ì •
                //  ë§Œì•½ countê°€ 0ë˜ëŠ” ì–‘ìˆ˜ë¼ë©´, í•´ë‹¹ ê¸€ìë¥¼ í‘œí˜„í•˜ê³ ë„ íƒ€ì´í•‘ ì¹´ìš´íŠ¸ê°€ ì¶©ë¶„í•˜ê±°ë‚˜ ë‚¨ì•˜ë‹¤ëŠ” ëœ»ì´ë¯€ë¡œ, í•´ë‹¹ ê¸€ìë¥¼ ê·¸ëŒ€ë¡œ ì¶œë ¥
                //  ë§Œì•½ countê°€ ìŒìˆ˜ë¼ë©´, í•´ë‹¹ ê¸€ìë¥¼ í‘œí˜„í•˜ëŠ”ë° í•„ìš”í•œ íƒ€ì´í•‘ ì¹´ìš´íŠ¸ê°€ ë¶€ì¡±í•˜ë¯€ë¡œ, ê¸€ìë¥¼ ë¶„ë¦¬í•´ì„œ ë‚¨ì€ íƒ€ì´í•‘ ì¹´ìš´íŠ¸ë§Œí¼ ì¶œë ¥
                //
                //##################################################################################################################################################

                // countê°’ì´ 0 ë˜ëŠ” ì–‘ìˆ˜ì¼ë•Œ, ê¸€ì ê·¸ëŒ€ë¡œ ì¶œë ¥
                if (count >= 0) {
                    result_string += str[index];

                // countê°’ì´ ìŒìˆ˜ì¼ ë•Œ, ê¸€ìë¥¼ ë¶„ë¦¬í•´ì„œ ë‚¨ì€ íƒ€ì´í•‘ ì¹´ìš´íŠ¸ë§Œí¼ ë§Œ ì¬ì¡°ë¦½ í›„ ì¶œë ¥
                } else {

                    //==============================================================================================================================================
                    //  ë¶ˆì™„ì „í•œ í•œê¸€('ã…¢', 'ã…™', 'ã„¾', 'ã„µ', ... )ì¼ ë•Œ, 
                    //==============================================================================================================================================
                    if (isSpecial) {
                        char result_char = ' ';
                        switch (str[index]) {
                            // 'ã…—'ë¥¼ ê¸°ë³¸í˜•ìœ¼ë¡œ ê°€ì§€ëŠ” ê²ƒë“¤
                            case 'ã…˜': case 'ã…™': case 'ã…š':
                                result_char = 'ã…—'; break;

                            // 'ã…œ' ë¥¼ ê¸°ë³¸í˜•ìœ¼ë¡œ ê°€ì§€ëŠ” ê²ƒë“¤
                            case 'ã…': case 'ã…': case 'ã…Ÿ':
                                result_char = 'ã…œ'; break;

                            // 'ã…¡' ë¥¼ ê¸°ë³¸í˜•ìœ¼ë¡œ ê°€ì§€ëŠ” ê²ƒ
                            case 'ã…¢':
                                result_char = 'ã…¡'; break;

                            // 'ã„±'ì„ ê¸°ë³¸í˜•ìœ¼ë¡œ ê°€ì§€ëŠ” ê²ƒ
                            case 'ã„³':
                                result_char = 'ã„±'; break;

                            // 'ã„´'ì„ ê¸°ë³¸í˜•ìœ¼ë¡œ ê°€ì§€ëŠ” ê²ƒë“¤
                            case 'ã„µ': case 'ã„¶':
                                result_char = 'ã„´'; break;

                            // 'ã„¹'ì„ ê¸°ë³¸í˜•ìœ¼ë¡œ ê°€ì§€ëŠ” ê²ƒë“¤
                            case 'ã„º': case 'ã„»': case 'ã„¼': case 'ã„½': case 'ã„¾': case 'ã„¿': case 'ã…€':
                                result_char = 'ã„¹'; break;

                            // 'ã…‚'ì„ ê¸°ë³¸í˜•ìœ¼ë¡œ ê°€ì§€ëŠ” ê²ƒ
                            case 'ã…„':
                                result_char = 'ã…‚'; break;

                            // ê¸°ë³¸ ê°’
                            default: result_char = ' '; break;
                        }

                        result_string += result_char;  // í•´ë‹¹ ê¸€ìë¥¼ ê²°ê³¼ stringì— ë”í•¨



                    //==============================================================================================================================================
                    //  ì™„ì „í•œ í•œê¸€ì¼ ë•Œ,
                    //==============================================================================================================================================
                    } else {
                        // ë¶„ë¦¬ í›„, ë‚¨ì€ íƒ€ì´í•‘ íšŸìˆ˜ë§Œí¼ ê¸€ìë¥¼ ì¬ì¡°ë¦½í•´ì•¼ í•˜ê¸° ë•Œë¬¸ì—, í•´ë‹¹ ê¸€ìì˜ ì´ˆì„±ê¹Œì§€ êµ¬í•´ì•¼ í•¨
                        int korean1stWord = ( wordIntValue ) / ( jongseong.Length * vowels.Length );

                        // ëª¨ë“  "ì™„ì „í•œ í•œê¸€"ì€ ìµœëŒ€ 5ë²ˆì˜ íƒ€ì´í•‘ ì¹´ìš´íŠ¸ë¥¼ ê°€ì§ˆ ìˆ˜ ìˆê³ , ë‹¤ìŒê³¼ ê°™ì€ ê²½ìš°ì˜ ìˆ˜ë¥¼ ê°€ì§
                        // â”Œâ”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                        // â”‚      â”‚                        â”‚        â”‚            ë‚¨ì€ íƒ€ì´í•‘ ì¹´ìš´íŠ¸          â”‚
                        // â”‚  No  â”‚         ì¡°í•©           â”‚  ì˜ˆì‹œ  â”‚â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”¤
                        // â”‚      â”‚                        â”‚        â”‚  1   â”‚  2   â”‚  3   â”‚  4   â”‚  5   â”‚ í•©  â”‚
                        // â”œâ”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”¤
                        // â”‚   1  â”‚  ì´ˆì„± + 1ì¤‘ì„± + 0ì¢…ì„±  â”‚  'ì˜ˆ'  â”‚  ã…‡  â”‚  ã…–  â”‚      â”‚      â”‚      â”‚  2  â”‚
                        // â”œâ”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”¤
                        // â”‚   2  â”‚  ì´ˆì„± + 1ì¤‘ì„± + 1ì¢…ì„±  â”‚  'ëŸ‰'  â”‚  ã„¹  â”‚  ã…‘  â”‚  ã…‡  â”‚      â”‚      â”‚  3  â”‚
                        // â”œâ”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”¤
                        // â”‚   3  â”‚  ì´ˆì„± + 2ì¤‘ì„± + 0ì¢…ì„±  â”‚  'ì¾Œ'  â”‚  ã…‹  â”‚  ã…—  â”‚  ã…  â”‚      â”‚      â”‚  3  â”‚
                        // â”œâ”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”¤
                        // â”‚   4  â”‚  ì´ˆì„± + 1ì¤‘ì„± + 2ì¢…ì„±  â”‚  'ì°®'  â”‚  ã…Š  â”‚  ã…  â”‚  ã„´  â”‚  ã…  â”‚      â”‚  4  â”‚
                        // â”œâ”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”¤
                        // â”‚   5  â”‚  ì´ˆì„± + 2ì¤‘ì„± + 1ì¢…ì„±  â”‚  'ê´œ'  â”‚  ã„±  â”‚  ã…—  â”‚  ã…  â”‚  ã„´  â”‚      â”‚  4  â”‚
                        // â”œâ”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”¤
                        // â”‚   6  â”‚  ì´ˆì„± + 2ì¤‘ì„± + 2ì¢…ì„±  â”‚  'íœ'  â”‚  ã…  â”‚  ã…œ  â”‚  ã…”  â”‚  ã…‚  â”‚  ã……  â”‚  5  â”‚
                        // â””â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”˜


                        //==========================================================================================================================================
                        //  ë‚¨ì€ ì¹´ìš´íŠ¸ê°€ 1ì¼ ê²½ìš°, ë°©ê¸ˆ êµ¬í•œ ì´ˆì„±ì„ ì¶œë ¥í•¨
                        //==========================================================================================================================================
                        if (wordDrawcount + count == 1) {
                            result_string += consonants[korean1stWord];


                        // ë‚¨ì€ ì¹´ìš´íŠ¸ê°€ 2 ì´ìƒì¼ ê²½ìš°, ê¸€ìë¥¼ ì¡°ë¦½ í•´ì•¼í•¨
                        } else{

                            // ì¡°ë¦½ì„ ìœ„í•´ ì´ˆì„±ì— í•´ë‹¹í•˜ëŠ” ê¸°ë³¸ ê¸€ìë¥¼ êµ¬í•¨. (Ex. 'ê±Š' -> ã„± -> 'ê°€' / 'ë™' -> ã„· -> 'ë‹¤' / 'í›¼' -> ã… -> 'í•˜' / ... )
                            int new_word_index = (int)'ê°€' + ( korean1stWord  * jongseong.Length * vowels.Length );

                            //======================================================================================================================================
                            //  ë‚¨ì€ ì¹´ìš´íŠ¸ê°€ 2ì¼ ê²½ìš°, ì´ˆì„±ê³¼ ëª¨ìŒì„ ê²°í•©í•œ ê¸€ì ì¶œë ¥
                            //======================================================================================================================================
                            if (wordDrawcount + count == 2) {
                                switch( korean2ndWord ) {
                                    // ì¤‘ì„±ì´ 'ã…˜', 'ã…™', 'ã…š' ì¸ ê²½ìš°, ì´ˆì„± + 'ã…—' ì¶œë ¥
                                    case 9: case 10: case 11:
                                        new_word_index += 8 * jongseong.Length; break;

                                    // ì¤‘ì„±ì´ 'ã…', 'ã…', 'ã…Ÿ' ì¸ ê²½ìš°, ì´ˆì„± + 'ã…œ' ì¶œë ¥
                                    case 14: case 15: case 16:
                                        new_word_index += 13 * jongseong.Length; break;

                                    // ì¤‘ì„±ì´ 'ã…¢'ì¸ ê²½ìš°, ì´ˆì„± + 'ã…¡' ì¶œë ¥
                                    case 19:
                                        new_word_index += 18 * jongseong.Length; break;

                                    // í•´ë‹¹ ì‚¬í•­ ì—†ìœ¼ë©´ ì´ˆì„± + ì¤‘ì„± ì¶œë ¥ 
                                    default:
                                        new_word_index += korean2ndWord * jongseong.Length; break;
                                }

                            //======================================================================================================================================
                            //  ë‚¨ì€ ì¹´ìš´íŠ¸ê°€ 3ì¼ ê²½ìš°
                            //======================================================================================================================================
                            } else if (wordDrawcount + count == 3) {
                                bool flag = false;                                                  // ì¤‘ì„±ì´ ëª¨ìŒ 2ê°œë¡œ ì´ë£¨ì–´ì ¸ ìˆëŠ”ì§€
                                switch( korean2ndWord ) {
                                    // 'ã…˜' 'ã…™' 'ã…š' 'ã…' 'ã…' 'ã…Ÿ' 'ã…¢' ë¼ë©´, flagëŠ” true
                                    case 9: case 10: case 11: case 14: case 15: case 16:case 19:
                                        flag = true; break;
                                    default: break;
                                }

                                // ì¼ë‹¨ ì¹´ìš´íŠ¸ê°€ 3ì´ìƒì´ë©´ ì´ˆì„± + ì¤‘ì„± ì¶œë ¥
                                new_word_index += korean2ndWord * jongseong.Length;

                                // ì¤‘ì„±ì´ ëª¨ìŒ í•˜ë‚˜ë¡œ ì´ë£¨ì–´ì ¸ ìˆì—ˆë‹¤ë©´, ì´ë²ˆì—ëŠ” ì¢…ì„±ê¹Œì§€ ì¶œë ¥
                                if (!flag) {

                                    // ì¢…ì„±ì´ ììŒ 2ê°œë¡œ ì´ë£¨ì–´ì ¸ ìˆë‹¤ë©´, ê¸°ë³¸í˜•ë§Œ ì¶œë ¥í•˜ê³  ì•„ë‹ˆë©´ ì „ë¶€ ì¶œë ¥
                                    switch( korean3rdWord ) {
                                        // ì¢…ì„±ì´ 'ã„³'ì¼ ê²½ìš°, 'ã„±' ì¶œë ¥
                                        case 3:
                                            new_word_index += 1; break;

                                        // ì¢…ì„±ì´ 'ã„µ' 'ã„¶'ì¼ ê²½ìš°, 'ã„´' ì¶œë ¥
                                        case 5: case 6:
                                            new_word_index += 4; break;

                                        // ì¢…ì„±ì´ 'ã„º' 'ã„»' 'ã„¼' 'ã„½' 'ã„¾' 'ã„¿' 'ã…€'ì¼ ê²½ìš°, 'ã„¹' ì¶œë ¥
                                        case 9: case 10: case 11: case 12: case 13: case 14: case 15:
                                            new_word_index += 8; break;

                                        // ì¢…ì„±ì´ 'ã…„' ì¼ ê²½ìš°, 'ã…‚' ì¶œë ¥
                                        case 18:
                                            new_word_index += 17; break;

                                        // ì¢…ì„±ì´ í•˜ë‚˜ì˜ ììŒì´ë¼ë©´, ëª¨ë‘ ì¶œë ¥
                                        default:  new_word_index += korean3rdWord; break;
                                    }
                                }

                            //======================================================================================================================================
                            //  ë‚¨ì€ ì¹´ìš´íŠ¸ê°€ 4ì¼ ê²½ìš°
                            //======================================================================================================================================
                            } else if (wordDrawcount + count == 4) {
                                bool flag = false;                                                  // ì¤‘ì„±ì´ ëª¨ìŒ 2ê°œë¡œ ì´ë£¨ì–´ì ¸ ìˆëŠ”ì§€
                                switch ( korean2ndWord ) {
                                    // 'ã…˜' 'ã…™' 'ã…š' 'ã…' 'ã…' 'ã…Ÿ' 'ã…¢' ë¼ë©´, flagëŠ” true
                                    case 9: case 10: case 11: case 14: case 15: case 16:case 19:
                                        flag = true; break;
                                    default: break;
                                }
                                // ì¼ë‹¨ ì¹´ìš´íŠ¸ê°€ 3ì´ìƒì´ë©´ ì´ˆì„± + ì¤‘ì„± ì¶œë ¥
                                new_word_index += korean2ndWord * jongseong.Length;

                                // ì¤‘ì„±ì´ ëª¨ìŒ í•˜ë‚˜ë¡œ ì´ë£¨ì–´ì ¸ ìˆëŠ” ê²½ìš°, ì´ˆì„± + ì¤‘ì„± + ì¢…ì„± ì¶œë ¥
                                if (!flag) new_word_index += korean3rdWord;

                                // ì¤‘ì„±ì´ ëª¨ìŒ ì—¬ëŸ¬ê°œë¡œ ì´ë£¨ì–´ì ¸ ìˆëŠ” ê²½ìš°, ì¢…ì„± í•˜ë‚˜ ì¶œë ¥
                                else {
                                    switch( korean3rdWord ) {
                                        // ì¢…ì„±ì´ 'ã„³'ì¼ ê²½ìš°, 'ã„±' ì¶œë ¥
                                        case 3:
                                            new_word_index += 1; break;

                                        // ì¢…ì„±ì´ 'ã„µ' 'ã„¶'ì¼ ê²½ìš°, 'ã„´' ì¶œë ¥
                                        case 5: case 6:
                                            new_word_index += 4; break;

                                        // ì¢…ì„±ì´ 'ã„º' 'ã„»' 'ã„¼' 'ã„½' 'ã„¾' 'ã„¿' 'ã…€'ì¼ ê²½ìš°, 'ã„¹' ì¶œë ¥
                                        case 9: case 10: case 11: case 12: case 13: case 14: case 15:
                                            new_word_index += 8; break;

                                        // ì¢…ì„±ì´ 'ã…„' ì¼ ê²½ìš°, 'ã…‚' ì¶œë ¥
                                        case 18:
                                            new_word_index += 17; break;

                                        // ì¢…ì„±ì´ í•˜ë‚˜ì˜ ììŒì´ë¼ë©´, ëª¨ë‘ ì¶œë ¥
                                        default: new_word_index += korean3rdWord; break;
                                    }
                                }
                            //======================================================================================================================================
                            //  ë‚¨ì€ ì¹´ìš´íŠ¸ê°€ 5ì¼ ê²½ìš°
                            //======================================================================================================================================
                            } else if (wordDrawcount + count == 5) {
                                // ì´ˆì„± + ì¤‘ì„± + ì¢…ì„±
                                new_word_index += korean2ndWord * jongseong.Length;
                                new_word_index += korean3rdWord;
                            }

                            //======================================================================================================================================
                            //  ê²°ê³¼ë¥¼ result_stringì— ì €ì¥
                            //======================================================================================================================================
                            result_string += (char)(new_word_index);
                        }
                    }
                }
            }

            // ëª¨ë“  ê¸€ìë¥¼ ëŒê±°ë‚˜, count ë³€ìˆ˜ê°€ ìŒìˆ˜ê°€ ë˜ì—ˆë‹¤ë©´, ì§€ê¸ˆê¹Œì§€ ê³„ì‚°í•œ result_stringê°’ ì¶œë ¥
            return result_string;
		}
        //==========================================================================================================================================================
        #endregion
    }
}
